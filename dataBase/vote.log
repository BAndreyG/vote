/*C4*/SET SCHEMA PUBLIC
DISCONNECT
/*C5*/SET SCHEMA PUBLIC
DROP TABLE votes IF EXISTS
DROP TABLE users IF EXISTS
DROP TABLE user_roles IF EXISTS
DROP TABLE restorans IF EXISTS
DROP TABLE menus IF EXISTS
DROP SEQUENCE GLOBAL_SEQ IF EXISTS
CREATE SEQUENCE GLOBAL_SEQ AS INTEGER START WITH 100000
CREATE TABLE users\u000a(\u000a    id         INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a    name       VARCHAR(50)            NOT NULL,\u000a    email      VARCHAR(255)           NOT NULL,\u000a    password   VARCHAR(255)           NOT NULL,\u000a    registered TIMESTAMP DEFAULT NOW  NOT NULL,\u000a    enabled    BOOLEAN   DEFAULT TRUE NOT NULL,\u000a    vote_id    INTEGER   DEFAULT 0    NOT NULL\u000a--     FOREIGN KEY (vote_id) REFERENCES VOTES (id)\u000a)
CREATE UNIQUE INDEX users_unique_name_password_idx\u000a    ON USERS (name, password)
CREATE TABLE user_roles\u000a(\u000a    user_id INTEGER NOT NULL,\u000a    role    VARCHAR(50),\u000a    CONSTRAINT user_roles_idx UNIQUE (user_id, role),\u000a    FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE\u000a)
CREATE TABLE restorans\u000a(\u000a    id       INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a    name     VARCHAR(50)       NOT NULL,\u000a    sum_vote INTEGER DEFAULT 0 NOT NULL\u000a)
CREATE TABLE menus\u000a(\u000a    id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a    name        VARCHAR(50)            NOT NULL,\u000a    price       DOUBLE                 NOT NULL,\u000a    enabled     BOOLEAN   DEFAULT TRUE NOT NULL,\u000a    registered  TIMESTAMP DEFAULT NOW  NOT NULL,\u000a    restoran_id INTEGER                NOT NULL,\u000a    FOREIGN KEY (restoran_id) REFERENCES RESTORANS (id)\u000a)
CREATE TABLE votes\u000a(\u000a    id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a    registered  TIMESTAMP DEFAULT NOW NOT NULL,\u000a    user_id     INTEGER,\u000a    restoran_id INTEGER,\u000a    FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE,\u000a    FOREIGN KEY (restoran_id) REFERENCES RESTORANS (id) ON DELETE CASCADE\u000a)
DISCONNECT
/*C6*/SET SCHEMA PUBLIC
DISCONNECT
/*C7*/SET SCHEMA PUBLIC
ALTER SEQUENCE global_seq RESTART WITH 100000
INSERT INTO USERS VALUES(100000,'User','user@yandex.ru','password','2019-12-13 02:26:56.332000',TRUE,0)
INSERT INTO USERS VALUES(100001,'Admin','admin@gmail.com','admin','2019-12-13 02:26:56.332000',TRUE,0)
ALTER SEQUENCE PUBLIC.GLOBAL_SEQ RESTART WITH 100002
COMMIT
INSERT INTO USER_ROLES VALUES(100000,'ROLE_USER')
INSERT INTO USER_ROLES VALUES(100001,'ROLE_ADMIN')
INSERT INTO USER_ROLES VALUES(100001,'ROLE_USER')
COMMIT
INSERT INTO RESTORANS VALUES(100002,'\u041f\u0435\u043b\u044c\u043c\u0435\u043d\u043d\u0430\u044f',0)
INSERT INTO RESTORANS VALUES(100003,'\u0421\u0443\u0448\u0438-\u0441\u0438\u0442\u0438',0)
COMMIT
INSERT INTO MENUS VALUES(100002,'\u041c\u0430\u043d\u043a\u0430',10.5E0,TRUE,'2015-05-30 10:00:00.000000',100002)
INSERT INTO MENUS VALUES(100003,'\u0413\u0440\u0435\u0447\u043a\u0430',200.0E0,TRUE,'2015-05-30 13:00:00.000000',100002)
INSERT INTO MENUS VALUES(100004,'\u0423\u0436\u0438\u043d',500.0E0,TRUE,'2015-05-30 20:00:00.000000',100002)
INSERT INTO MENUS VALUES(100005,'\u0417\u0430\u0432\u0442\u0440\u0430\u043a',500.0E0,TRUE,'2015-05-31 10:00:00.000000',100002)
INSERT INTO MENUS VALUES(100006,'\u041e\u0431\u0435\u0434',1000.0E0,TRUE,'2015-05-31 13:00:00.000000',100002)
INSERT INTO MENUS VALUES(100007,'\u0423\u0436\u0438\u043d',510.0E0,TRUE,'2015-05-31 20:00:00.000000',100002)
INSERT INTO MENUS VALUES(100008,'\u0410\u0434\u043c\u0438\u043d \u043b\u0430\u043d\u0447',510.0E0,TRUE,'2015-06-01 14:00:00.000000',100003)
INSERT INTO MENUS VALUES(100009,'\u0410\u0434\u043c\u0438\u043d \u0443\u0436\u0438\u043d',1500.0E0,TRUE,'2015-06-01 21:00:00.000000',100003)
ALTER SEQUENCE PUBLIC.GLOBAL_SEQ RESTART WITH 100010
COMMIT
INSERT INTO VOTES VALUES(100010,'2015-05-30 10:00:00.000000',100001,100002)
ALTER SEQUENCE PUBLIC.GLOBAL_SEQ RESTART WITH 100011
COMMIT
DISCONNECT
/*C8*/SET SCHEMA PUBLIC
DISCONNECT
/*C9*/SET SCHEMA PUBLIC
DISCONNECT
